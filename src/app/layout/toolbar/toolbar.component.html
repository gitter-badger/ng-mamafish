<header class="header box-shadow pre">
  <cat-top-info></cat-top-info>
  <div nz-row>
    <div nz-col nzSpan="8">
      <button nz-button nzType="large">
        <i nz-icon type="bars"></i>
      </button>
      <div class="divider"></div>
      <button nz-button nzType="large">
        <i nz-icon type="arrow-down"></i>
      </button>
      <div class="divider"></div>
      <button nz-button nzType="large">
        <i nz-icon type="lock"></i>
      </button>
    </div>
    <div nz-col nzSpan="16" class="tr">
      <ng-container *ngTemplateOutlet="user"></ng-container>
      <ng-container *ngTemplateOutlet="search"></ng-container>
      <ng-container *ngTemplateOutlet="bell"></ng-container>
      <ng-container *ngTemplateOutlet="fullscreen"></ng-container>
      <ng-container *ngTemplateOutlet="settings"></ng-container>
    </div>
  </div>
</header>

<ng-template #user>
  <nz-dropdown [nzTrigger]="'click'" [nzPlacement]="'bottomCenter'" class="tc">
    <div class="dib user-box" nz-dropdown>
      <nz-avatar [nzSize]="40" nzIcon="user" nzSrc="../../../assets/images/avatar.jpg" class="avatar fl"></nz-avatar>
      <button nz-button nzType="primary" class="user-btn">
        <span class="ell name">smileboyi</span>
        <i nz-icon type="down" theme="outline"></i>
      </button>
    </div>
    <ul nz-menu class="user-menu">
      <li nz-menu-item>
        <button nz-button nzType="default">
          <i nz-icon type="user"></i>个人信息
        </button>
      </li>
      <li nz-menu-item>
        <button nz-button nzType="default">
          <i nz-icon type="mail"></i>收件箱
        </button>
      </li>
      <li nz-menu-item>
        <button nz-button nzType="default">
          <i nz-icon type="poweroff"></i>退出
        </button>
      </li>
    </ul>
  </nz-dropdown>
  <div class="divider"></div>
</ng-template>

<ng-template #search>
  <button nz-button nzType="large" (click)="showSearchBar()">
    <i nz-icon type="search"></i>
  </button>
  <div class="search-bar pab wh100 not nol z50 flex" [hidden]="!searchBarState">
    <label class="fe">
      <input
        class="wh100 ipt"
        type="text"
        placeholder="搜索"
        #serchIpt
        autofocus="autofocus"
      />
    </label>
    <button
      nz-button
      nzType="default"
      nzShape="circle"
      (click)="searchBarState = false"
    >
      <i nz-icon type="close" theme="outline"></i>
    </button>
  </div>
  <div class="divider"></div>
</ng-template>

<ng-template #fullscreen>
  <button nz-button nzType="large" (click)="toggleFullscreen()">
    <i nz-icon [type]="isFullscreen ? 'fullscreen-exit' : 'fullscreen'"></i>
  </button>
  <div class="divider"></div>
</ng-template>

<ng-template #bell>
  <nz-dropdown [nzTrigger]="'click'" [nzPlacement]="'bottomCenter'">
    <button nz-button nz-dropdown nzTrigger="click">
      <i nz-icon type="bell"></i>
    </button>
    <div class="box-shadow inform-box">
      <nz-tabset nzSize="small">
        <nz-tab [nzTitle]="titleTemplate1">
          <div class="scrollbar wh100" *ngIf="userMessage">
            <div
              class="message-item flex"
              *ngFor="let message of userMessage.messages"
            >
              <nz-avatar
                nzSize="50"
                nzIcon="user"
                [nzSrc]="message.avatar"
              ></nz-avatar>
              <div class="fe main">
                <div>
                  <span class="name">{{ message.name }}</span>
                  <span class="time fr">{{ message.time }}</span>
                </div>
                <p class="text ell">
                  {{ message.text }}
                </p>
              </div>
            </div>
          </div>
        </nz-tab>
        <nz-tab [nzTitle]="titleTemplate2">
          <div class="scrollbar wh100" *ngIf="userMessage">
            <div class="file-item" *ngFor="let file of userMessage.files">
              <div>
                <span class="name">{{ file.name }}</span
                ><span class="size fr">{{ file.size }}</span>
              </div>
              <nz-progress
                [nzPercent]="file.value"
                [nzStrokeWidth]="3"
                [nzShowInfo]="false"
                [nzStrokeColor]="file.color"
              ></nz-progress>
            </div>
          </div>
        </nz-tab>
        <nz-tab [nzTitle]="titleTemplate3">
          <div class="scrollbar wh100" *ngIf="userMessage">
            <div
              class="schedule-item flex"
              *ngFor="let schedule of userMessage.schedules"
            >
              <div
                class="date"
                [ngStyle]="{ 'background-color': schedule.bgColor }"
              >
                <div>{{ schedule.day }}</div>
                <div class="month">{{ schedule.month }}</div>
              </div>
              <div class="fe">
                <p class="title">{{ schedule.title }}</p>
                <p class="text">
                  {{ schedule.text }}
                </p>
              </div>
            </div>
          </div>
        </nz-tab>
      </nz-tabset>
    </div>
  </nz-dropdown>
  <div class="divider"></div>
</ng-template>

<ng-template #settings>
  <button nz-button nzType="large" (click)="openSetting()">
    <i nz-icon type="setting"></i>
  </button>
</ng-template>

<ng-template #titleTemplate1>
  <i nz-icon type="message" theme="fill"></i>
</ng-template>
<ng-template #titleTemplate2>
  <i nz-icon type="file" theme="fill"></i>
</ng-template>
<ng-template #titleTemplate3>
  <i nz-icon type="schedule" theme="fill"></i>
</ng-template>

<nz-drawer
  [nzVisible]="drawerVisible"
  nzPlacement="right"
  nzTitle="主题选项"
  [nzWidth]="280"
  [nzMaskStyle]="bgctp"
  (nzOnClose)="handleDrawerClose()"
>
  <p>Some contents...</p>
  <p>Some contents...</p>
  <p>Some contents...</p>
</nz-drawer>
